{% extends "base.html" %}
{% block content %}
  <h2>Gestion de la scolarité</h2>

  {% if request.method == "GET" %}
    <form method="post">
      <label>Mot de passe</label>
      <input type="password" name="password" required>
      <button class="btn-large">Valider</button>
    </form>
  {% endif %}

  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      {% for cat, msg in messages %}
        <p class="flash {{ cat }}">{{ msg }}</p>
      {% endfor %}
    {% endif %}
  {% endwith %}

  {% if eleves is defined %}
    <p style="margin-top:30px;font-weight:bold;">Liste complète avec prix de scolarité</p>
    <table>
      <thead>
        <tr>
          <th>Nom</th>
          <th>Prénoms</th>
          <th>Classe</th>
          <th>Téléphone tuteur</th>
          <th>Prix scolarité (FCFA)</th>
          <th>Paiements</th>
        </tr>
      </thead>
      <tbody>
        {% for e in eleves %}
        <tr>
          <td>{{ e.nom }}</td>
          <td>{{ e.prenoms }}</td>
          <td>{{ e.classe }}</td>
          <td>{{ e.contact }}</td>
          <td>{{ "{:,}".format(e.prix_scolarite).replace(',', ' ') }} FCFA</td>
          <td>{{ e.paiements|length }} enregistré(s)</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  {% endif %}
{% endblock %}
